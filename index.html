<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AOD 환불 정책 Q&A 챗봇 (CS 내부용)</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>💡</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #2d1b4e;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 800px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            background: rgba(255, 255, 255, 0.2);
            padding: 4px;
            border-radius: 20px;
        }
        
        .language-toggle button {
            padding: 6px 14px;
            background: transparent;
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .language-toggle button.active {
            background: white;
            color: #667eea;
        }
        
        .language-toggle button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: #f7f7f7;
        }
        
        .message {
            margin-bottom: 16px;
            display: flex;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            justify-content: flex-end;
        }
        
        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 12px;
            word-wrap: break-word;
        }
        
        .message.bot .message-content {
            background: white;
            color: #333;
            border: 1px solid #e0e0e0;
        }
        
        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .message-label {
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 6px;
            opacity: 0.7;
        }
        
        .quick-questions {
            padding: 16px 24px;
            background: white;
            border-top: 1px solid #e0e0e0;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .quick-questions h3 {
            font-size: 14px;
            margin-bottom: 12px;
            color: #667eea;
            font-weight: 600;
        }
        
        .quick-question-btn {
            display: block;
            width: 100%;
            text-align: left;
            padding: 10px 14px;
            margin-bottom: 8px;
            background: #f7f7f7;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            color: #333;
        }
        
        .quick-question-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateX(4px);
        }
        
        .input-container {
            padding: 20px 24px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 12px;
        }
        
        .input-container input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 24px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }
        
        .input-container input:focus {
            border-color: #667eea;
        }
        
        .input-container button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 24px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .input-container button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .input-container button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .footer {
            padding: 12px 24px;
            background: white;
            border-top: 1px solid #e0e0e0;
            text-align: center;
            font-size: 12px;
            color: #999;
        }
        
        .footer a {
            color: #667eea;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.7;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
        
        .policy-box {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
            font-size: 13px;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
            font-size: 13px;
        }
        
        .info-tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 6px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-toggle">
                <button id="langKo" class="active" onclick="changeLanguage('ko')">한국어</button>
                <button id="langEn" onclick="changeLanguage('en')">English</button>
            </div>
            <h1 id="headerTitle">🎮 AOD 환불 정책 Q&A</h1>
            <p id="headerSubtitle">CS 담당자 전용 | 빠른 정책 검색 도구</p>
        </div>
        
        <div class="chat-container" id="chatContainer">
            <div class="message bot">
                <div>
                    <div class="message-label">🤖 정책봇</div>
                    <div class="message-content">
                        안녕하세요! AOD 서비스 종료 환불 정책 Q&A 챗봇입니다. 🎮<br><br>
                        궁금한 환불 정책을 질문해주시거나, 아래 자주 묻는 질문을 선택해주세요.
                    </div>
                </div>
            </div>
        </div>
        
        <div class="quick-questions">
            <h3 id="quickQuestionsTitle">💡 자주 묻는 질문 (클릭)</h3>
            <button class="quick-question-btn" onclick="askQuestion('환불 대상 조건이 뭔가요?')">환불 대상 조건이 뭔가요?</button>
            <button class="quick-question-btn" onclick="askQuestion('iOS 유저인데 어떻게 환불 받나요?')">iOS 유저인데 어떻게 환불 받나요?</button>
            <button class="quick-question-btn" onclick="askQuestion('영수증 캡쳐를 다 공유해야 하나요?')">영수증 캡쳐를 다 공유해야 하나요?</button>
            <button class="quick-question-btn" onclick="askQuestion('환불이 아직 처리되지 않았어요')">환불이 아직 처리되지 않았어요</button>
            <button class="quick-question-btn" onclick="askQuestion('계정을 삭제했는데 환불 가능한가요?')">계정을 삭제했는데 환불 가능한가요?</button>
            <button class="quick-question-btn" onclick="askQuestion('환불 대상이 아닌 이유가 뭔가요?')">환불 대상이 아닌 이유가 뭔가요?</button>
            <button class="quick-question-btn" onclick="askQuestion('v1.1 이후 구매한 백금주화도 환불되나요?')">v1.1 이후 구매한 백금주화도 환불되나요?</button>
            <button class="quick-question-btn" onclick="askQuestion('v1.0 시즌 백금주화를 나중에 썼는데 환불되나요?')">v1.0 시즌 백금주화를 나중에 썼는데 환불되나요?</button>
        </div>
        
        <div class="input-container">
            <input type="text" id="userInput" placeholder="환불 정책 질문을 입력하세요..." onkeypress="handleKeyPress(event)">
            <button onclick="sendMessage()" id="sendBtn">전송</button>
        </div>
        
        <div class="footer">
            Made by JEEYEA CHA
        </div>
    </div>

    <script>
        let currentLanguage = 'ko';
        
        const translations = {
            ko: {
                headerTitle: '🎮 AOD 환불 정책 Q&A',
                headerSubtitle: 'CS 담당자 전용 | 빠른 정책 검색 도구',
                botLabel: '🤖 정책봇',
                userLabel: '👤 CS 담당자',
                quickQuestionsTitle: '💡 자주 묻는 질문 (클릭)',
                inputPlaceholder: '환불 정책 질문을 입력하세요...',
                sendButton: '전송',
                welcomeMessage: '안녕하세요! AOD 서비스 종료 환불 정책 Q&A 챗봇입니다. 🎮<br><br>궁금한 환불 정책을 질문해주시거나, 아래 자주 묻는 질문을 선택해주세요.',
                quickQuestions: [
                    '환불 대상 조건이 뭔가요?',
                    'iOS 유저인데 어떻게 환불 받나요?',
                    '영수증 캡쳐를 다 공유해야 하나요?',
                    '환불이 아직 처리되지 않았어요',
                    '계정을 삭제했는데 환불 가능한가요?',
                    '환불 대상이 아닌 이유가 뭔가요?',
                    'v1.1 이후 구매한 백금주화도 환불되나요?',
                    'v1.0 시즌 백금주화를 나중에 썼는데 환불되나요?'
                ]
            },
            en: {
                headerTitle: '🎮 AOD Refund Policy Q&A',
                headerSubtitle: 'For CS Team | Quick Policy Reference Tool',
                botLabel: '🤖 Policy Bot',
                userLabel: '👤 CS Agent',
                quickQuestionsTitle: '💡 Frequently Asked Questions (Click)',
                inputPlaceholder: 'Ask about refund policy...',
                sendButton: 'Send',
                welcomeMessage: 'Hello! This is the AOD service termination refund policy Q&A chatbot. 🎮<br><br>Please ask your questions about the refund policy, or select from the frequently asked questions below.',
                quickQuestions: [
                    'What are the refund eligibility criteria?',
                    'How can iOS users get a refund?',
                    'Do I need to share all receipt screenshots?',
                    'My refund hasn\'t been processed yet',
                    'Can I get a refund if I deleted my account?',
                    'Why am I not eligible for a refund?',
                    'Are platinum coins purchased after v1.1 refunded?',
                    'Are v1.0 season coins used later refunded?'
                ]
            }
        };
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Update UI text
            document.getElementById('headerTitle').innerHTML = translations[lang].headerTitle;
            document.getElementById('headerSubtitle').innerHTML = translations[lang].headerSubtitle;
            document.getElementById('quickQuestionsTitle').innerHTML = translations[lang].quickQuestionsTitle;
            document.getElementById('userInput').placeholder = translations[lang].inputPlaceholder;
            document.getElementById('sendBtn').innerHTML = translations[lang].sendButton;
            
            // Update language toggle buttons
            document.getElementById('langKo').classList.toggle('active', lang === 'ko');
            document.getElementById('langEn').classList.toggle('active', lang === 'en');
            
            // Update quick question buttons
            const quickBtns = document.querySelectorAll('.quick-question-btn');
            translations[lang].quickQuestions.forEach((question, index) => {
                if (quickBtns[index]) {
                    quickBtns[index].textContent = question;
                    quickBtns[index].onclick = () => askQuestion(question);
                }
            });
            
            // Clear chat and show welcome message
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            addMessage(translations[lang].welcomeMessage, false);
        }
        
        const REFUND_POLICY = {
            period: {
                start: "2026년 1월 21일(수)",
                end: "2026년 3월 21일(토)"
            },
            eligible: {
                iap_after_v11: {
                    desc: "v1.1(2025.10.1) 이후 구입한 모든 IAP상품",
                    includes: ["패스 상품 2종 포함"],
                    period: "2025년 10월 1일 이후"
                },
                platinum_coins: {
                    desc: "서비스 시작~v1.0시즌 기간 내 구입 후 사용하고 남은 유료 백금주화",
                    period: "2025년 2월 5일 ~ 2025년 9월 30일",
                    condition: "사용하고 남은"
                }
            },
            ineligible: {
                event_coins: "이벤트 및 인-게임 보상을 통해 획득한 백금주화",
                used_coins: "v1.2시즌 이전에 유료로 구하였으나 게임에서 정상적으로 사용한 백금주화",
                other_currency: "마일리지, 시즌코인, 패스코인"
            },
            calculation: {
                rate: "1백금주화당 17.14원(KRW)",
                base: "백금주화 가치 기준"
            }
        };

        function getAnswer(question) {
            if (currentLanguage === 'ko') {
                return getAnswerKo(question);
            } else {
                return getAnswerEn(question);
            }
        }
        
        function getAnswerKo(question) {
            const q = question.toLowerCase();
            
            // 환불 대상 조건
            if (q.includes('환불 대상') || q.includes('대상 조건') || q.includes('누가 받') || q.includes('대상인가')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 대상</span><br><br>
                    <strong>✅ 1. v1.1 이후 IAP 상품 (2025.10.1 이후)</strong><br>
                    • 모든 IAP 상품 전액 환불<br>
                    • 패스 상품 2종도 포함<br><br>
                    
                    <strong>✅ 2. v1.0 시즌 유료 백금주화 잔여분</strong><br>
                    • 기간: 2025.2.5 ~ 2025.9.30<br>
                    • 조건: 구입 후 <u>사용하고 남은</u> 백금주화만<br>
                    • 1백금주화당 17.14원 계산
                </div>
                
                <strong>🎯 유저 답변 예시:</strong><br>
                "고객님의 구매 내역을 확인해보니, [해당/비해당] 됩니다. v1.1(2025.10.1) 이후 구매하신 상품은 전액 환불 대상이며, 그 이전 구매분은 사용하지 않고 남은 백금주화만 환불됩니다."`;
            }
            
            // 환불 불가
            if (q.includes('환불 불가') || q.includes('안 되') || q.includes('제외') || q.includes('못 받')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">환불 불가</span><br><br>
                    <strong>❌ 1. 이벤트/보상 백금주화</strong><br>
                    • 무료로 획득한 모든 백금주화<br>
                    • 출석 보상, 퀘스트 보상 등<br><br>
                    
                    <strong>❌ 2. 이미 사용한 백금주화</strong><br>
                    • v1.0 시즌(~2025.9.30) 이전에 유료 구매 후 사용한 백금주화<br>
                    • "사용하고 남은" 분만 환불 대상<br><br>
                    
                    <strong>❌ 3. 기타 게임 재화</strong><br>
                    • 마일리지, 시즌코인, 패스코인<br>
                    • 백금주화가 아닌 모든 재화
                </div>
                
                <strong>⚠️ CS 주의사항:</strong><br>
                "왜 안 되냐"는 질문에는 위 기준을 명확히 안내하되, <strong>"유료로 구입하신 백금주화 중 사용하지 않은 잔여분"</strong>이라는 표현을 강조하세요.`;
            }
            
            // 계산 방법
            if (q.includes('계산') || q.includes('얼마') || q.includes('금액') || q.includes('17.14')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 계산</span><br><br>
                    <strong>💰 백금주화 환불 기준:</strong><br>
                    • 1백금주화 = 17.14원(KRW)<br><br>
                    
                    <strong>📊 계산 예시:</strong><br>
                    • 남은 백금주화 100개 → 1,714원 환불<br>
                    • 남은 백금주화 500개 → 8,570원 환불<br>
                    • 남은 백금주화 1,000개 → 17,140원 환불<br><br>
                    
                    <strong>⚠️ 주의:</strong><br>
                    • v1.1 이후 IAP 상품은 <u>결제 금액 전액</u> 환불<br>
                    • v1.0 시즌 백금주화만 위 비율로 계산
                </div>
                
                <strong>🎯 유저 답변 템플릿:</strong><br>
                "고객님께서 남은 백금주화는 [X]개로 확인되며, 환불 예상 금액은 [X × 17.14]원입니다. v1.1 이후 구매하신 상품은 결제 금액 전액이 환불됩니다."`;
            }
            
            // 환불 기간
            if (q.includes('기간') || q.includes('언제') || q.includes('날짜') || q.includes('접수')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 신청 기간</span><br><br>
                    <strong>📅 신청 가능 기간:</strong><br>
                    <strong style="font-size:16px; color:#667eea;">2026년 1월 21일(수) ~ 2026년 3월 21일(토)</strong><br><br>
                    
                    총 <strong>60일간</strong> 신청 가능합니다.
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ 기한 지난 문의 대응:</strong><br>
                    • "기한 내 신청하지 못한 경우 환불 불가" 명확히 안내<br>
                    • 공지는 [게임 내 / 공식 커뮤니티 / 이메일]로 발송되었음 안내<br>
                    • 예외 처리는 <u>불가능</u>하다고 명확히 전달
                </div>
                
                <strong>🎯 CS 스크립트:</strong><br>
                "환불 신청 기간은 2026년 1월 21일부터 3월 21일까지입니다. 기간 내에 신청하신 경우 순차적으로 처리되며, 기한 경과 시 환불이 불가합니다."`;
            }
            
            // v1.1 이전/이후 구분
            if (q.includes('v1.1') || q.includes('v1.0') || q.includes('10월') || q.includes('이전') || q.includes('이후')) {
                return `<div class="policy-box">
                    <span class="info-tag">버전별 환불 기준</span><br><br>
                    <strong>✅ v1.1 이후 (2025.10.1~)</strong><br>
                    • 모든 IAP 상품 <u>전액 환불</u><br>
                    • 패스 상품 포함<br><br>
                    
                    <strong>⚠️ v1.0 시즌 (2025.2.5~9.30)</strong><br>
                    • 유료 백금주화 중 <u>사용하고 남은 분만</u><br>
                    • 1백금주화당 17.14원 계산<br>
                    • 이미 사용한 분은 환불 불가
                </div>
                
                <strong>💬 유저가 헷갈리는 포인트:</strong><br>
                • "10월 1일에 산 건 환불되나요?" → <strong>YES (전액)</strong><br>
                • "9월 30일에 산 건요?" → <strong>남은 백금주화만</strong>`;
            }
            
            // 패스 상품
            if (q.includes('패스') || q.includes('시즌')) {
                return `<div class="policy-box">
                    <span class="info-tag">패스 상품</span><br><br>
                    <strong>✅ v1.1 이후 패스 구매:</strong><br>
                    • 패스 상품 2종 모두 환불 대상<br>
                    • 전액 환불<br><br>
                    
                    <strong>❌ v1.0 이전 패스:</strong><br>
                    • 패스로 받은 백금주화만 계산<br>
                    • 이미 사용했다면 환불 불가
                </div>
                
                <strong>⚠️ 시즌코인, 패스코인:</strong><br>
                패스를 통해 획득한 <u>시즌코인, 패스코인은 환불 불가</u>입니다. 오직 백금주화만 환불 대상입니다.`;
            }
            
            // 사용/미사용
            if (q.includes('사용') || q.includes('썼') || q.includes('남은') || q.includes('잔여')) {
                return `<div class="policy-box">
                    <span class="info-tag">사용 여부 기준</span><br><br>
                    <strong>✅ v1.1 이후 구매 (2025.10.1~)</strong><br>
                    • 전액 환불<br>
                    • 백금주화(플래티넘 코인)도 IAP 상품이므로 사용 여부 무관 환불<br><br>
                    
                    <strong>⚠️ v1.0 시즌 백금주화 (2025.2.5~9.30)</strong><br>
                    • <u>사용하고 남은 백금주화만</u> 환불<br>
                    • 이미 사용한 백금주화는 환불 불가<br>
                    • 일부 사용 시 → 남은 수량만 계산<br>
                    • <strong>단, v1.0 시즌 이후에 사용했더라도 환불됩니다</strong>
                </div>
                
                <div class="warning-box">
                    <strong>🔥 자주 나오는 항의:</strong><br>
                    "어차피 서비스 종료인데 왜 사용한 건 환불 안 해줘요?"<br><br>
                    
                    <strong>→ 대응 방법:</strong><br>
                    "v1.1 이후 구매하신 상품은 전액 환불해드립니다. 다만 v1.0 시즌(~2025.9.30)에 구매하신 백금주화는 해당 시즌 내에 사용하신 분량은 환불 대상에서 제외됩니다. v1.0 시즌 이후에 사용하신 경우는 환불됩니다."
                </div>`;
            }
            
            // v1.1 이후 백금주화 환불
            if (q.includes('v1.1') && (q.includes('백금') || q.includes('플래티넘') || q.includes('코인')) && q.includes('환불')) {
                return `<div class="policy-box">
                    <span class="info-tag">v1.1 이후 백금주화 환불</span><br><br>
                    <strong>✅ v1.1 이후 구매한 백금주화(플래티넘 코인):</strong><br>
                    • 백금주화도 IAP 상품입니다<br>
                    • 사용 여부와 상관없이 전액 환불됩니다<br>
                    • 다 사용했어도 환불 대상입니다
                </div>
                
                <strong>💬 유저 답변 예시:</strong><br>
                "v1.1(2025.10.1) 이후 구매하신 백금주화는 IAP 상품으로 분류되어, 사용 여부와 관계없이 전액 환불됩니다."`;
            }
            
            // v1.0 시즌 백금주화를 v1.0 이후 사용
            if ((q.includes('v1.0') || q.includes('시즌')) && q.includes('이후') && q.includes('사용')) {
                return `<div class="policy-box">
                    <span class="info-tag">v1.0 시즌 백금주화 사용 시점</span><br><br>
                    <strong>✅ v1.0 시즌 이후 사용한 경우:</strong><br>
                    • v1.0 시즌(2025.2.5~9.30)에 구매한 백금주화를<br>
                    • v1.0 시즌 <u>이후에</u> 사용하셨다면<br>
                    • <strong>환불됩니다</strong><br><br>
                    
                    <strong>❌ v1.0 시즌 내 사용한 경우만 제외:</strong><br>
                    • v1.0 시즌 내에 사용한 백금주화만 환불 불가
                </div>
                
                <strong>💬 유저 답변 예시:</strong><br>
                "v1.0 시즌(~2025.9.30)에 구매하신 백금주화를 해당 시즌 이후에 사용하셨다면 환불 대상입니다. v1.0 시즌 내에 사용한 경우만 환불에서 제외됩니다."`;
            }
            
            // 이벤트/보상
            if (q.includes('이벤트') || q.includes('보상') || q.includes('무료') || q.includes('공짜')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">무료 재화 환불 불가</span><br><br>
                    <strong>❌ 환불 불가 재화:</strong><br>
                    • 이벤트로 받은 백금주화<br>
                    • 출석 보상<br>
                    • 퀘스트 보상<br>
                    • 미션 달성 보상<br>
                    • 랭킹 보상<br>
                    • 모든 인-게임 무료 획득 백금주화<br><br>
                    
                    <strong>✅ 환불 가능:</strong><br>
                    • <u>실제 결제로 구입한</u> 백금주화만
                </div>
                
                <strong>💬 유저 대응 팁:</strong><br>
                "유료로 구매하신 백금주화만 환불 대상입니다. 이벤트나 보상으로 받은 백금주화는 실제 금전적 지출이 발생하지 않았으므로 환불 대상이 아닙니다."`;
            }
            
            // 마일리지/시즌코인/패스코인
            if (q.includes('마일리지') || q.includes('시즌코인') || q.includes('패스코인')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">환불 불가 재화</span><br><br>
                    <strong>❌ 환불 불가:</strong><br>
                    • 마일리지<br>
                    • 시즌코인<br>
                    • 패스코인<br>
                    • 기타 백금주화가 아닌 모든 게임 재화<br><br>
                    
                    <strong>✅ 환불 가능:</strong><br>
                    • 백금주화만 (조건 충족 시)
                </div>
                
                <strong>🎯 명확한 안내:</strong><br>
                "환불 대상은 백금주화만 해당됩니다. 마일리지, 시즌코인, 패스코인 등 다른 게임 재화는 환불되지 않습니다."`;
            }
            
            // iOS 환불
            if (q.includes('ios') || q.includes('아이폰') || q.includes('애플') || q.includes('앱스토어') || q.includes('앱 스토어')) {
                return `<div class="policy-box">
                    <span class="info-tag">iOS 환불</span><br><br>
                    <strong>📱 iOS 유저 환불 절차:</strong><br>
                    1. 저희가 환불 리스트를 공유해드립니다<br>
                    2. 해당 항목을 <u>직접 앱스토어 고객센터를 통해 환불 신청</u>해주세요<br>
                    3. 만약 환불이 거절될 경우 → 다시 저희에게 연락주세요
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ iOS 특이사항:</strong><br>
                    • 애플 정책상 환불은 앱스토어를 통해서만 가능<br>
                    • 저희가 직접 환불 처리 불가<br>
                    • 거절 시 추가 지원 가능
                </div>
                
                <strong>🎯 유저 답변 템플릿:</strong><br>
                "iOS의 경우 애플 정책에 따라 앱스토어를 통한 환불이 필요합니다. 고객님의 환불 대상 항목 리스트를 전달해드리겠습니다. 해당 내역을 가지고 앱스토어 고객센터에서 환불 신청해주시고, 만약 거절되시면 다시 연락 주시기 바랍니다."`;
            }
            
            // 영수증 관련
            if (q.includes('영수증') || q.includes('캡처') || q.includes('캡쳐') || q.includes('스크린샷') || q.includes('증빙')) {
                return `<div class="policy-box">
                    <span class="info-tag">영수증 제출</span><br><br>
                    <strong>📱 애플(iOS) 유저:</strong><br>
                    • <u>잔여 백금주화 + IAP 상품</u> 모두 환불 받는 경우<br>
                    • <strong>모든 결제 영수증 스크린샷 필수</strong><br>
                    • 이유: 잔여 백금주화를 달러로 환산 후, 결제 내역 중 해당 금액과 근접한 상품을 찾아 환불 처리<br><br>
                    
                    <strong>🤖 구글(Android) 유저:</strong><br>
                    • 저희가 모든 영수증을 확인 가능<br>
                    • 영수증 스크린샷 불필요<br><br>
                    
                    <strong>📸 영수증이 너무 많은 경우 (iOS):</strong><br>
                    • JEEYEA에게 직접 연락 주세요<br>
                    • 별도 처리 방법 안내받으실 수 있습니다
                </div>
                
                <strong>⚠️ CS 담당자 참고:</strong><br>
                • <strong>[iOS 유저]</strong> 잔여 백금주화와 IAP 상품을 함께 환불받는 경우, 백금주화를 달러로 환산한 금액에 맞는 결제 항목을 찾아 환불 처리하기 위해 모든 결제 영수증 스크린샷이 필요합니다.<br>
                • <strong>[Android 유저]</strong> 구글 플레이는 저희가 결제 내역을 확인할 수 있어 영수증 제출이 필요하지 않습니다.<br>
                • iOS 유저 중 영수증이 너무 많은 케이스는 JEEYEA에게 에스컬레이션하세요.`;
            }
            
            // 현금 환불
            if (q.includes('현금') || q.includes('계좌') || q.includes('송금') || q.includes('이체')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 방식</span><br><br>
                    <strong>✅ 기본 환불 방식:</strong><br>
                    • 스토어 결제 내역 환불이 원칙입니다<br>
                    • 원래 결제 수단으로 자동 환불<br>
                    • 구글 플레이 / 앱스토어 정책 따름<br><br>
                    
                    <strong>⚠️ 특수한 경우:</strong><br>
                    • 매우 특수한 상황에 한해 계좌 이체 가능<br>
                    • 해당 케이스는 개별 검토 필요
                </div>
                
                <strong>💬 유저 답변:</strong><br>
                "환불은 원칙적으로 스토어 결제 내역을 통해 진행되며, 원래 결제하신 수단(카드/계정)으로 환불됩니다. 다만 특수한 상황의 경우 개별적으로 검토하여 계좌 이체로 진행할 수 있으니, 구체적인 상황을 말씀해주시면 확인해드리겠습니다."<br><br>
                
                <strong>⚠️ CS 담당자 참고:</strong><br>
                계좌 이체 요청 시 상위 매니저에게 에스컬레이션하여 특수 케이스 해당 여부를 판단받으세요.`;
            }
            
            // 엑솔라 결제
            if (q.includes('엑솔라') || q.includes('xsolla')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">엑솔라(Xsolla) 결제</span><br><br>
                    <strong>⚠️ 엑솔라 결제 건 환불:</strong><br>
                    • 저희는 엑솔라 결제 환불 권한이 없습니다<br>
                    • <strong>엑솔라 고객센터를 통해 환불 신청</strong>해주세요<br><br>
                    
                    <strong>📞 엑솔라 고객센터:</strong><br>
                    • 엑솔라 공식 고객센터로 문의 필요
                </div>
                
                <strong>💬 유저 답변:</strong><br>
                "엑솔라를 통해 결제하신 건에 대해서는 저희가 환불 권한이 없습니다. 엑솔라 고객센터를 통해 환불 신청을 진행해주시기 바랍니다."<br><br>
                
                <strong>⚠️ CS 담당자 참고:</strong><br>
                엑솔라 결제 건은 저희 권한 밖이므로 명확히 안내하세요.`;
            }
            
            // 계정 삭제/탈퇴
            if (q.includes('탈퇴') || q.includes('삭제') || q.includes('계정') && (q.includes('삭제') || q.includes('탈퇴'))) {
                return `<div class="policy-box">
                    <span class="info-tag">계정 삭제/탈퇴</span><br><br>
                    <strong>✅ 환불 가능합니다!</strong><br><br>
                    
                    <strong>📝 필요 정보:</strong><br>
                    계정 정보만 확실하게 기억하고 있으면 됩니다<br>
                    • 메인 닉네임<br>
                    • 어카운트 ID<br><br>
                    
                    위 정보를 제공해주시면 환불 처리 가능합니다.
                </div>
                
                <strong>💬 유저 답변:</strong><br>
                "계정을 삭제하셨어도 환불 가능합니다. 메인 닉네임과 어카운트 ID를 확인해주시면 환불 처리 도와드리겠습니다."`;
            }
            
            // 환불 처리 지연
            if (q.includes('아직') || q.includes('안 들어왔') || q.includes('안들어왔') || q.includes('처리') && q.includes('안') || q.includes('언제')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 처리</span><br><br>
                    <strong>⏱ 환불 처리 일정:</strong><br>
                    • 환불은 <u>순차적으로</u> 처리됩니다<br>
                    • 플랫폼(구글/애플) 정책에 따라 시간이 소요됩니다<br>
                    • 결제에 사용한 원래 결제 수단으로 환불됩니다<br><br>
                    
                    <strong>📅 일반적인 소요 시간:</strong><br>
                    • 구글 플레이: 3~5일<br>
                    • 앱스토어: 5~7일<br>
                    • 카드사 정산 일정에 따라 추가 시간 소요 가능
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ 지연되는 경우:</strong><br>
                    • 대량 환불로 인한 순차 처리<br>
                    • 플랫폼 내부 검토 진행 중<br>
                    • 결제 수단(카드) 정산 주기
                </div>
                
                <strong>💬 유저 답변:</strong><br>
                "환불은 순차적으로 진행되고 있으며, 플랫폼 정책상 실제 환불까지 3~7일 정도 소요될 수 있습니다. 조금만 기다려주시면 원래 결제 수단으로 환불 완료됩니다."`;
            }
            
            // 환불 대상 아닌 이유
            if (q.includes('대상 아닌') || q.includes('제외') && q.includes('이유') || q.includes('왜 안')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">환불 제외 사유</span><br><br>
                    <strong>❌ 다음 경우 환불 대상에서 제외됩니다:</strong>
                </div>
                
                <strong>1️⃣ 환불 기준 기간 이전 결제 건</strong><br>
                • v1.0 시즌(2025.2.5~9.30) 이전 결제<br>
                • v1.1(2025.10.1) 이후만 전액 환불<br><br>
                
                <strong>2️⃣ 결제 상품을 이미 전부 사용한 경우</strong><br>
                • v1.0 시즌 백금주화를 모두 소진<br>
                • "남은 백금주화"만 환불 대상<br><br>
                
                <strong>3️⃣ 무료/보너스로 지급된 재화</strong><br>
                • 이벤트 보상<br>
                • 출석 보상<br>
                • 퀘스트 보상<br>
                • 실제 결제하지 않은 모든 재화<br><br>
                
                <strong>4️⃣ 환불 정책상 제외된 상품</strong><br>
                • 마일리지<br>
                • 시즌코인<br>
                • 패스코인<br>
                • 백금주화 외 모든 게임 재화
                
                <div class="policy-box" style="margin-top:16px;">
                    <strong>✅ 개별 케이스 확인:</strong><br>
                    고객님의 구체적인 결제 내역을 확인해드리면 정확한 사유를 안내드릴 수 있습니다.
                </div>`;
            }
            
            // 환불 기준 동의 어려움
            if (q.includes('동의') && q.includes('어렵') || q.includes('납득') || q.includes('이해') && q.includes('안')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">기준 이의 제기</span><br><br>
                    <strong>📋 공식 입장:</strong>
                </div>
                
                <strong>서비스 종료에 따른 환불은 관련 법령 및 내부 정책에 따라 진행됩니다.</strong><br><br>
                
                <strong>✅ 적용 원칙:</strong><br>
                • 모든 유저에게 <u>동일한 기준</u>이 적용됩니다<br>
                • 개별 예외 적용은 어렵습니다<br>
                • 공정한 환불 처리를 위한 기준입니다<br><br>
                
                <div class="policy-box">
                    <strong>💬 공감형 답변:</strong><br>
                    "고객님의 의견 충분히 이해합니다. 다만 환불 정책은 관련 법령과 내부 기준에 따라 모든 유저에게 동일하게 적용되고 있습니다. 개별 예외를 적용하기 어려운 점 양해 부탁드립니다."
                </div>
                
                <strong>⚠️ 강경한 태도 시:</strong><br>
                상위 매니저에게 에스컬레이션하고 추가 대응 지시를 받으세요.`;
            }
            
            // 환불 방법/처리
            if (q.includes('어떻게') || q.includes('방법') || q.includes('신청') || q.includes('절차')) {
                return `<div class="policy-box">
                    <span class="info-tag">환불 신청 방법</span><br><br>
                    <strong>📝 신청 절차:</strong><br>
                    (구체적인 신청 방법은 내부 문서 확인 필요)<br><br>
                    
                    일반적으로:<br>
                    • CS 센터 또는 별도 환불 신청 페이지<br>
                    • 계정 정보 + 결제 내역 제출<br>
                    • 검토 후 승인/반려 통보<br>
                    • 승인 시 결제 수단으로 환불
                </div>
                
                <strong>⏱ 처리 기간:</strong><br>
                (내부 정책 확인 필요 - 일반적으로 7~14일)`;
            }
            
            // 왜 환불 안 되냐 (항의성)
            if (q.includes('왜') || q.includes('차별') || q.includes('불공평') || q.includes('이상하') || q.includes('말이 안')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">민감한 문의</span><br><br>
                    <strong>🔥 감정적 대응 필요 케이스</strong>
                </div>
                
                <strong>✅ 대응 가이드:</strong><br><br>
                
                1️⃣ <strong>공감 먼저</strong><br>
                "서비스 종료로 인해 불편을 드려 죄송합니다."<br><br>
                
                2️⃣ <strong>명확한 기준 안내</strong><br>
                "환불 정책은 구매 시점과 사용 여부를 기준으로 공정하게 적용됩니다."<br><br>
                
                3️⃣ <strong>구체적 설명</strong><br>
                • v1.1 이후: 모든 상품 전액 환불<br>
                • v1.0 시즌: 사용 안 한 백금주화만<br>
                • 무료 획득 재화: 실제 지출 없어 환불 불가<br><br>
                
                4️⃣ <strong>추가 지원 안내</strong><br>
                "추가 문의사항이 있으시면 언제든 말씀해주세요."<br><br>
                
                <div class="warning-box">
                    <strong>⚠️ 절대 하지 말 것:</strong><br>
                    • "규정이에요" 같은 기계적 답변<br>
                    • 유저 비난 ("공지 안 읽으셨네요")<br>
                    • 방어적 태도<br><br>
                    
                    <strong>✅ 해야 할 것:</strong><br>
                    • 감정 공감 → 명확한 기준 → 구체적 케이스 설명
                </div>`;
            }
            
            // 법적 대응 언급
            if (q.includes('신고') || q.includes('소비자') || q.includes('법') || q.includes('소송')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">법적 이슈 멘션</span><br><br>
                    <strong>🚨 즉시 에스컬레이션</strong>
                </div>
                
                <strong>⚠️ 대응 절차:</strong><br>
                1. 차분하게 "고객님의 의견 전달하겠습니다" 안내<br>
                2. 상위 매니저에게 즉시 보고<br>
                3. 추가 대응은 지시 대기<br><br>
                
                <strong>❌ 절대 하지 말 것:</strong><br>
                • 법적 판단 제시<br>
                • "소용없다"는 식의 발언<br>
                • 유저와 법적 논쟁<br><br>
                
                <strong>✅ 적절한 답변:</strong><br>
                "고객님의 의견 소중히 받아들이겠습니다. 관련 부서에 전달 후 검토하여 별도로 연락드리겠습니다."`;
            }
            
            // 그 외 일반 질문
            return `죄송합니다. 해당 질문에 대한 답변을 찾지 못했습니다. 😅<br><br>
            <strong>다시 시도해보세요:</strong><br>
            • "환불 대상은?"<br>
            • "계산 방법은?"<br>
            • "v1.1 이후는 어떻게?"<br>
            • "이벤트 백금주화는?"<br><br>
            
            또는 구체적인 상황을 설명해주시면 더 정확한 답변을 드릴 수 있습니다!`;
        }
        
        function getAnswerEn(question) {
            const q = question.toLowerCase();
            
            // Refund eligibility criteria
            if (q.includes('eligib') || q.includes('criteria') || q.includes('who') || q.includes('qualif')) {
                return `<div class="policy-box">
                    <span class="info-tag">Refund Eligibility</span><br><br>
                    <strong>✅ 1. IAP Products Purchased After v1.1 (After Oct 1, 2025)</strong><br>
                    • Full refund for all IAP products<br>
                    • Includes 2 pass products<br><br>
                    
                    <strong>✅ 2. Remaining Paid Platinum Coins from v1.0 Season</strong><br>
                    • Period: Feb 5, 2025 ~ Sep 30, 2025<br>
                    • Condition: Only <u>remaining unused</u> platinum coins after purchase<br>
                    • Calculated at 17.14 KRW per platinum coin
                </div>
                
                <strong>🎯 User Response Example:</strong><br>
                "After checking your purchase history, you are [eligible/not eligible]. Products purchased after v1.1 (Oct 1, 2025) are eligible for full refund, while purchases before that date are only eligible for unused platinum coins."`;
            }
            
            // Ineligible items
            if (q.includes('ineligib') || q.includes('not eligible') || q.includes('excluded') || q.includes('cannot')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">Ineligible for Refund</span><br><br>
                    <strong>❌ 1. Event/Reward Platinum Coins</strong><br>
                    • All platinum coins obtained for free<br>
                    • Attendance rewards, quest rewards, etc.<br><br>
                    
                    <strong>❌ 2. Already Used Platinum Coins</strong><br>
                    • Platinum coins purchased before v1.0 season (~Sep 30, 2025) and already used<br>
                    • Only "remaining after use" is eligible<br><br>
                    
                    <strong>❌ 3. Other In-Game Currency</strong><br>
                    • Mileage, Season Coins, Pass Coins<br>
                    • All currency other than platinum coins
                </div>
                
                <strong>⚠️ CS Note:</strong><br>
                For "why not" questions, clearly explain the above criteria, emphasizing <strong>"only remaining unused platinum coins from paid purchases"</strong>.`;
            }
            
            // Calculation method
            if ((q.includes('calculat') || q.includes('how much') || q.includes('17.14')) || 
                (q.includes('amount') && !q.includes('hasn\'t') && !q.includes('not') && !q.includes('come'))) {
                return `<div class="policy-box">
                    <span class="info-tag">Refund Calculation</span><br><br>
                    <strong>💰 Platinum Coin Refund Rate:</strong><br>
                    • 1 platinum coin = 17.14 KRW<br><br>
                    
                    <strong>📊 Calculation Examples:</strong><br>
                    • 100 remaining platinum coins → 1,714 KRW refund<br>
                    • 500 remaining platinum coins → 8,570 KRW refund<br>
                    • 1,000 remaining platinum coins → 17,140 KRW refund<br><br>
                    
                    <strong>⚠️ Note:</strong><br>
                    • IAP products after v1.1 receive <u>full payment amount</u> refund<br>
                    • Only v1.0 season platinum coins are calculated at the above rate
                </div>
                
                <strong>🎯 User Response Template:</strong><br>
                "Your remaining platinum coins are confirmed as [X], and the estimated refund amount is [X × 17.14] KRW. Products purchased after v1.1 will be refunded in full payment amount."`;
            }
            
            // Refund period
            if (q.includes('period') || q.includes('when') || q.includes('date') || q.includes('deadline')) {
                return `<div class="policy-box">
                    <span class="info-tag">Refund Application Period</span><br><br>
                    <strong>📅 Application Period:</strong><br>
                    <strong style="font-size:16px; color:#667eea;">January 21, 2026 (Wed) ~ March 21, 2026 (Sat)</strong><br><br>
                    
                    Applications available for a total of <strong>60 days</strong>.
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ Handling Late Applications:</strong><br>
                    • "Refunds not available if not applied within the deadline" - clear guidance<br>
                    • Notification was sent via [in-game / official community / email]<br>
                    • No exceptions possible
                </div>
                
                <strong>🎯 CS Script:</strong><br>
                "The refund application period is from January 21 to March 21, 2026. Applications submitted within this period will be processed sequentially. Refunds cannot be processed after the deadline."`;
            }
            
            // iOS refund
            if (q.includes('ios') || q.includes('iphone') || q.includes('apple') || q.includes('app store')) {
                return `<div class="policy-box">
                    <span class="info-tag">iOS Refund</span><br><br>
                    <strong>📱 iOS User Refund Process:</strong><br>
                    1. We will share the refund list with you<br>
                    2. Please <u>apply for refund directly through the App Store customer center</u> for those items<br>
                    3. If the refund is rejected → Please contact us again
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ iOS Special Notes:</strong><br>
                    • Due to Apple policy, refunds are only possible through the App Store<br>
                    • We cannot process refunds directly<br>
                    • Additional support available if rejected
                </div>
                
                <strong>🎯 User Response Template:</strong><br>
                "For iOS, refunds must be processed through the App Store according to Apple policy. We will provide you with a list of eligible refund items. Please apply for a refund at the App Store customer center with this information, and contact us again if rejected."`;
            }
            
            // Receipt submission
            if (q.includes('receipt') || q.includes('capture') || q.includes('screenshot') || q.includes('proof')) {
                return `<div class="policy-box">
                    <span class="info-tag">Receipt Submission</span><br><br>
                    <strong>📱 Apple (iOS) Users:</strong><br>
                    • If receiving refund for <u>remaining platinum coins + IAP products</u><br>
                    • <strong>Screenshots of all payment receipts required</strong><br>
                    • Reason: Need to convert remaining platinum coins to USD and find matching purchase item close to that amount for refund processing<br><br>
                    
                    <strong>🤖 Google (Android) Users:</strong><br>
                    • We can view all receipts on our end<br>
                    • Receipt screenshots not required<br><br>
                    
                    <strong>📸 If you have too many receipts (iOS):</strong><br>
                    • Please contact JEEYEA directly<br>
                    • You can receive guidance on alternative processing methods
                </div>
                
                <strong>⚠️ CS Agent Note:</strong><br>
                • <strong>[iOS Users]</strong> For refunds combining remaining platinum coins and IAP products, all payment receipt screenshots are needed to find the purchase item matching the USD-converted platinum coin amount for refund processing.<br>
                • <strong>[Android Users]</strong> For Google Play, we can check payment history on our end, so receipt submission is not required.<br>
                • For iOS users with too many receipts, escalate to JEEYEA.`;
            }
            
            // Cash refund
            if (q.includes('cash') || q.includes('bank') || q.includes('transfer') || q.includes('wire')) {
                return `<div class="policy-box">
                    <span class="info-tag">Refund Method</span><br><br>
                    <strong>✅ Standard Refund Method:</strong><br>
                    • Store payment history refund is the principle<br>
                    • Automatic refund to original payment method<br>
                    • Follows Google Play / App Store policy<br><br>
                    
                    <strong>⚠️ Special Cases:</strong><br>
                    • Bank transfer may be available in very special circumstances<br>
                    • Such cases require individual review
                </div>
                
                <strong>💬 User Response:</strong><br>
                "Refunds are processed in principle through store payment history and will be refunded to your original payment method (card/account). However, in special circumstances, we can review individual cases and process via bank transfer. Please let us know your specific situation and we will check for you."<br><br>
                
                <strong>⚠️ CS Agent Note:</strong><br>
                For bank transfer requests, escalate to senior manager to determine if it qualifies as a special case.`;
            }
            
            // Xsolla payment
            if (q.includes('xsolla')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">Xsolla Payment</span><br><br>
                    <strong>⚠️ Xsolla Payment Refunds:</strong><br>
                    • We do not have refund authority for Xsolla payments<br>
                    • <strong>Please apply for refund through Xsolla customer center</strong><br><br>
                    
                    <strong>📞 Xsolla Customer Center:</strong><br>
                    • Contact official Xsolla customer support
                </div>
                
                <strong>💬 User Response:</strong><br>
                "For payments made through Xsolla, we do not have refund authority. Please proceed with refund application through Xsolla customer center."<br><br>
                
                <strong>⚠️ CS Agent Note:</strong><br>
                Xsolla payments are outside our authority, so provide clear guidance.`;
            }
            
            // Account deletion
            if (q.includes('delet') || q.includes('withdraw') || q.includes('account') && (q.includes('delet') || q.includes('withdraw'))) {
                return `<div class="policy-box">
                    <span class="info-tag">Account Deletion/Withdrawal</span><br><br>
                    <strong>✅ Refunds are available!</strong><br><br>
                    
                    <strong>📝 Required Information:</strong><br>
                    You just need to clearly remember your account information:<br>
                    • Main nickname<br>
                    • Account ID<br><br>
                    
                    Refund processing is possible if you provide the above information.
                </div>
                
                <strong>💬 User Response:</strong><br>
                "Even if you've deleted your account, refunds are still available. If you can confirm your main nickname and account ID, we can help you with the refund process."`;
            }
            
            // Processing delay (check before calculation to catch "amount hasn't come in")
            if (q.includes('hasn\'t come') || q.includes('not come') || q.includes('hasn\'t arrived') || 
                q.includes('not arrived') || q.includes('hasn\'t been received') || q.includes('not received') ||
                q.includes('not yet') || q.includes('delay') || q.includes('waiting') || 
                (q.includes('hasn\'t') && (q.includes('process') || q.includes('refund')))) {
                return `<div class="policy-box">
                    <span class="info-tag">Refund Processing</span><br><br>
                    <strong>⏱ Refund Processing Schedule:</strong><br>
                    • Refunds are processed <u>sequentially</u><br>
                    • Time required according to platform (Google/Apple) policy<br>
                    • Refunded to original payment method used<br><br>
                    
                    <strong>📅 Typical Processing Time:</strong><br>
                    • Google Play: 3-5 days<br>
                    • App Store: 5-7 days<br>
                    • Additional time may be required depending on card company settlement schedule
                </div>
                
                <div class="warning-box">
                    <strong>⚠️ When Delayed:</strong><br>
                    • Sequential processing due to high volume<br>
                    • Platform internal review in progress<br>
                    • Payment method (card) settlement cycle
                </div>
                
                <strong>💬 User Response:</strong><br>
                "Refunds are being processed sequentially, and it may take 3-7 days for actual refund according to platform policy. Please wait a little longer, and the refund will be completed to your original payment method."`;
            }
            
            // Reasons for ineligibility
            if (q.includes('not eligible') || q.includes('excluded') && q.includes('reason') || q.includes('why not')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">Refund Exclusion Reasons</span><br><br>
                    <strong>❌ You are excluded from refunds in the following cases:</strong>
                </div>
                
                <strong>1️⃣ Payments made before the refund criteria period</strong><br>
                • Payments before v1.0 season (Feb 5 ~ Sep 30, 2025)<br>
                • Only after v1.1 (Oct 1) eligible for full refund<br><br>
                
                <strong>2️⃣ Already used all purchased products</strong><br>
                • All v1.0 season platinum coins already consumed<br>
                • Only "remaining platinum coins" are eligible<br><br>
                
                <strong>3️⃣ Currency distributed for free/as bonus</strong><br>
                • Event rewards<br>
                • Attendance rewards<br>
                • Quest rewards<br>
                • All currency not actually paid for<br><br>
                
                <strong>4️⃣ Products excluded by refund policy</strong><br>
                • Mileage<br>
                • Season coins<br>
                • Pass coins<br>
                • All in-game currency other than platinum coins
                
                <div class="policy-box" style="margin-top:16px;">
                    <strong>✅ Individual Case Review:</strong><br>
                    We can provide you with exact reasons if we check your specific payment history.
                </div>`;
            }
            
            // Disagreement with criteria
            if (q.includes('disagree') || q.includes('unfair') || q.includes('not understand')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">Objection to Criteria</span><br><br>
                    <strong>📋 Official Position:</strong>
                </div>
                
                <strong>Refunds due to service termination are processed according to relevant laws and internal policies.</strong><br><br>
                
                <strong>✅ Application Principles:</strong><br>
                • <u>Same criteria</u> applied to all users<br>
                • Individual exceptions are difficult<br>
                • Criteria for fair refund processing<br><br>
                
                <div class="policy-box">
                    <strong>💬 Empathetic Response:</strong><br>
                    "We fully understand your opinion. However, the refund policy is applied equally to all users according to relevant laws and internal standards. We ask for your understanding that individual exceptions are difficult to apply."
                </div>
                
                <strong>⚠️ In case of firm stance:</strong><br>
                Escalate to senior manager and await further response instructions.`;
            }
            
            // Legal issues
            if (q.includes('report') || q.includes('consumer') || q.includes('law') || q.includes('lawsuit')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">Legal Issue Mention</span><br><br>
                    <strong>🚨 Immediate Escalation</strong>
                </div>
                
                <strong>⚠️ Response Procedure:</strong><br>
                1. Calmly inform "We will convey your opinion"<br>
                2. Immediately report to senior manager<br>
                3. Wait for instructions on further response<br><br>
                
                <strong>❌ Never Do:</strong><br>
                • Provide legal judgment<br>
                • Say "it's useless"<br>
                • Engage in legal debate with user<br><br>
                
                <strong>✅ Appropriate Response:</strong><br>
                "We will take your opinion seriously. We will review it with the relevant department and contact you separately."`;
            }
            
            // v1.1 before/after distinction
            if (q.includes('v1.1') || q.includes('v1.0') || q.includes('october') || q.includes('before') || q.includes('after')) {
                return `<div class="policy-box">
                    <span class="info-tag">Version-based Refund Criteria</span><br><br>
                    <strong>✅ After v1.1 (Oct 1, 2025~)</strong><br>
                    • All IAP products <u>full refund</u><br>
                    • Includes pass products<br><br>
                    
                    <strong>⚠️ v1.0 Season (Feb 5 ~ Sep 30, 2025)</strong><br>
                    • Only <u>remaining unused</u> paid platinum coins<br>
                    • Calculated at 17.14 KRW per platinum coin<br>
                    • Already used portion not eligible
                </div>
                
                <strong>💬 Confusing Points for Users:</strong><br>
                • "Purchased on Oct 1, eligible?" → <strong>YES (Full)</strong><br>
                • "Purchased on Sep 30?" → <strong>Remaining coins only</strong>`;
            }
            
            // Pass products
            if (q.includes('pass') || q.includes('season')) {
                return `<div class="policy-box">
                    <span class="info-tag">Pass Products</span><br><br>
                    <strong>✅ Pass purchased after v1.1:</strong><br>
                    • Both pass products eligible<br>
                    • Full refund<br><br>
                    
                    <strong>❌ Pass before v1.0:</strong><br>
                    • Only platinum coins received from pass calculated<br>
                    • Not eligible if already used
                </div>
                
                <strong>⚠️ Season Coins, Pass Coins:</strong><br>
                <u>Season coins and pass coins obtained through pass are not eligible</u>. Only platinum coins are eligible for refund.`;
            }
            
            // Usage/Non-usage
            if (q.includes('use') || q.includes('used') || q.includes('remain') || q.includes('left')) {
                return `<div class="policy-box">
                    <span class="info-tag">Usage Criteria</span><br><br>
                    <strong>✅ Purchases after v1.1 (Oct 1, 2025~)</strong><br>
                    • Full refund<br>
                    • Platinum coins are also IAP products, refunded regardless of usage<br><br>
                    
                    <strong>⚠️ v1.0 Season Platinum Coins (Feb 5 ~ Sep 30, 2025)</strong><br>
                    • Only <u>remaining platinum coins after use</u><br>
                    • Already used platinum coins not eligible<br>
                    • Partial use → Only remaining amount calculated<br>
                    • <strong>However, refunded even if used after v1.0 season</strong>
                </div>
                
                <div class="warning-box">
                    <strong>🔥 Common Complaints:</strong><br>
                    "Service is terminating anyway, why not refund used items?"<br><br>
                    
                    <strong>→ Response Method:</strong><br>
                    "Products purchased after v1.1 will be fully refunded. However, platinum coins purchased during v1.0 season (~Sep 30, 2025) that were used within that season are excluded from refunds. If used after v1.0 season, they are refunded."
                </div>`;
            }
            
            // v1.1 platinum coin refund
            if (q.includes('v1.1') && (q.includes('platinum') || q.includes('coin')) && q.includes('refund')) {
                return `<div class="policy-box">
                    <span class="info-tag">v1.1 Platinum Coin Refund</span><br><br>
                    <strong>✅ Platinum coins purchased after v1.1:</strong><br>
                    • Platinum coins are IAP products<br>
                    • Fully refunded regardless of usage<br>
                    • Eligible even if fully used
                </div>
                
                <strong>💬 User Response Example:</strong><br>
                "Platinum coins purchased after v1.1 (Oct 1, 2025) are classified as IAP products and will be fully refunded regardless of usage."`;
            }
            
            // v1.0 platinum coins used after v1.0
            if ((q.includes('v1.0') || q.includes('season')) && q.includes('after') && q.includes('use')) {
                return `<div class="policy-box">
                    <span class="info-tag">v1.0 Season Platinum Coin Usage Timing</span><br><br>
                    <strong>✅ If used after v1.0 season:</strong><br>
                    • Platinum coins purchased during v1.0 season (Feb 5 ~ Sep 30, 2025)<br>
                    • If used <u>after</u> v1.0 season<br>
                    • <strong>Are refunded</strong><br><br>
                    
                    <strong>❌ Only excluded if used within v1.0 season:</strong><br>
                    • Only platinum coins used within v1.0 season are not refunded
                </div>
                
                <strong>💬 User Response Example:</strong><br>
                "If you used platinum coins purchased during v1.0 season (~Sep 30, 2025) after that season, they are eligible for refund. Only those used within v1.0 season are excluded from refunds."`;
            }
            
            // Event/Rewards
            if (q.includes('event') || q.includes('reward') || q.includes('free') || q.includes('bonus')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">Free Currency Not Eligible</span><br><br>
                    <strong>❌ Ineligible Currency:</strong><br>
                    • Platinum coins from events<br>
                    • Attendance rewards<br>
                    • Quest rewards<br>
                    • Mission achievement rewards<br>
                    • Ranking rewards<br>
                    • All platinum coins obtained for free in-game<br><br>
                    
                    <strong>✅ Eligible:</strong><br>
                    • Only platinum coins <u>purchased with actual payment</u>
                </div>
                
                <strong>💬 User Response Tip:</strong><br>
                "Only platinum coins purchased with payment are eligible for refund. Platinum coins received through events or rewards are not eligible since no actual monetary expenditure occurred."`;
            }
            
            // Other currencies
            if (q.includes('mileage') || q.includes('season coin') || q.includes('pass coin')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#ffc107;">Ineligible Currency</span><br><br>
                    <strong>❌ Not Eligible:</strong><br>
                    • Mileage<br>
                    • Season coins<br>
                    • Pass coins<br>
                    • All in-game currency other than platinum coins<br><br>
                    
                    <strong>✅ Eligible:</strong><br>
                    • Only platinum coins (when conditions met)
                </div>
                
                <strong>🎯 Clear Guidance:</strong><br>
                "Only platinum coins are eligible for refund. Other game currencies such as mileage, season coins, and pass coins are not refundable."`;
            }
            
            // Why complaints
            if (q.includes('why') || q.includes('unfair') || q.includes('discrimination') || q.includes('makes no sense')) {
                return `<div class="warning-box">
                    <span class="info-tag" style="background:#dc3545;">Sensitive Inquiry</span><br><br>
                    <strong>🔥 Case Requiring Emotional Response</strong>
                </div>
                
                <strong>✅ Response Guide:</strong><br><br>
                
                1️⃣ <strong>Empathy First</strong><br>
                "We apologize for the inconvenience caused by the service termination."<br><br>
                
                2️⃣ <strong>Clear Criteria Guidance</strong><br>
                "Refund policy is applied fairly based on purchase timing and usage status."<br><br>
                
                3️⃣ <strong>Specific Explanation</strong><br>
                • After v1.1: Full refund for all products<br>
                • v1.0 season: Only unused platinum coins<br>
                • Free-obtained currency: Not eligible as no actual expenditure<br><br>
                
                4️⃣ <strong>Offer Additional Support</strong><br>
                "Please feel free to contact us if you have any additional questions."<br><br>
                
                <div class="warning-box">
                    <strong>⚠️ Never Do:</strong><br>
                    • Mechanical responses like "it's the rule"<br>
                    • Blame user ("you didn't read the notice")<br>
                    • Defensive attitude<br><br>
                    
                    <strong>✅ Must Do:</strong><br>
                    • Empathy → Clear criteria → Specific case explanation
                </div>`;
            }
            
            // General question
            return `Sorry, I couldn't find an answer to that question. 😅<br><br>
            <strong>Please try again:</strong><br>
            • "Who is eligible?"<br>
            • "How is it calculated?"<br>
            • "What about after v1.1?"<br>
            • "Event platinum coins?"<br><br>
            
            Or you can explain your specific situation for a more accurate answer!`;
        }

        function addMessage(content, isUser = false) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const label = isUser ? translations[currentLanguage].userLabel : translations[currentLanguage].botLabel;
            
            messageDiv.innerHTML = `
                <div>
                    <div class="message-label">${label}</div>
                    <div class="message-content">${content}</div>
                </div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function showTyping() {
            const chatContainer = document.getElementById('chatContainer');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot';
            typingDiv.id = 'typing-indicator';
            
            const botLabel = translations[currentLanguage].botLabel;
            
            typingDiv.innerHTML = `
                <div>
                    <div class="message-label">${botLabel}</div>
                    <div class="message-content">
                        <div class="typing-indicator">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function removeTyping() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessage(message, true);
            input.value = '';
            
            showTyping();
            
            setTimeout(() => {
                removeTyping();
                const answer = getAnswer(message);
                addMessage(answer, false);
            }, 1000);
        }

        function askQuestion(question) {
            const input = document.getElementById('userInput');
            input.value = question;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
    </script>
</body>
</html>